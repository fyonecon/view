<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<div id="content_views2" class="markdown_views prism-atom-one-light">
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
    </svg>
    <p>chan在go中是一个<a href="https://so.csdn.net/so/search?q=%E9%80%9A%E9%81%93&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E9%80%9A%E9%81%93&amp;spm=1001.2101.3001.7020&quot;}" data-tit="通道" data-pretit="通道">通道</a>有可读可写的chan,也存在只读只写的chan,通过共享内存而实现通信</p>
    <p>chan 注意点：<br> 在关闭chan后再关闭chan 会出现panic<br> 关闭chan后可以继续进行取值，取完后可以再取但都是对应类型的0值。<br> 可以通过 v,ok:=&lt;-ch 来判断是否取完了 取完了ok为false<br> 也可以通过for range 来取值</p>
    <pre data-index="0" class="prettyprint"><code class="prism language-go has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">for</span> v：<span class="token operator">=</span> <span class="token keyword">range</span> ch<span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"the data is %d"</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
	 v<span class="token punctuation">,</span>ok<span class="token operator">:=</span><span class="token operator">&lt;-</span>ch
	 <span class="token keyword">if</span> ！ok<span class="token punctuation">{<!-- --></span>
	 fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"the data is %d"</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span>
	 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"取完了"</span><span class="token punctuation">)</span>
	 <span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"the data is %d"</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li></ul></pre>
    <p>chan需要初始化：</p>
    <pre data-index="1" class="prettyprint"><code class="prism language-go has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token comment">//开辟缓冲区为20的chan</span>
ch1<span class="token operator">:=</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">//无缓冲区的chan</span>
ch2<span class="token operator">:=</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token comment">//只能向chan内写</span>
ch3<span class="token operator">:=</span><span class="token function">make</span><span class="token punctuation">(</span> <span class="token keyword">chan</span><span class="token operator">&lt;-</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
ch3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
ch3 <span class="token operator">&lt;-</span> <span class="token number">10</span>
ch3 <span class="token operator">&lt;-</span> <span class="token number">20</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>ch3<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//只能从chan内读</span>
ch4<span class="token operator">:=</span><span class="token function">make</span><span class="token punctuation">(</span>ch<span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li></ul></pre>
    <p>chan 不给缓冲区无法放入值，在某些情况<br> 但是你可以开另外的goroutine来取值，快递原理，不在家储物柜没位置，无法放入快递（放值），快递柜满了，有人来取则可以取值</p>
    <p>产生数据并开24个线程消耗数据，并将数据的每一位的和传到主goroutine进行打印<br> goroutine</p>
    <pre data-index="2" class="prettyprint"><code class="prism language-go has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"math"</span>
	<span class="token string">"math/rand"</span>
	<span class="token string">"sync"</span>
<span class="token punctuation">)</span>

<span class="token comment">//generate int64 number</span>
<span class="token keyword">func</span> <span class="token function">generateRandomNumber</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// var i int64</span>
	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		ch <span class="token operator">&lt;-</span> <span class="token function">int64</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">Int63</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//get the sum of all digit of input number</span>
<span class="token comment">// 获取输入数的每一位的和</span>
<span class="token keyword">func</span> <span class="token function">GetSum</span><span class="token punctuation">(</span>s <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token builtin">int64</span> <span class="token punctuation">{<!-- --></span>
	strNum <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
	lenNum <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>strNum<span class="token punctuation">)</span>
	<span class="token keyword">var</span> sumOfAllDigit <span class="token builtin">int64</span> <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> lenNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span> <span class="token punctuation">{<!-- --></span>
		temp <span class="token operator">:=</span> s <span class="token operator">/</span> <span class="token function">int64</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">Pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token function">float64</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
		s <span class="token operator">=</span> s <span class="token operator">%</span> <span class="token function">int64</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">Pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token function">float64</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		sumOfAllDigit <span class="token operator">+=</span> temp
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"sum is "</span><span class="token punctuation">,</span> sumOfAllDigit<span class="token punctuation">)</span>
	<span class="token keyword">return</span> sumOfAllDigit
<span class="token punctuation">}</span>

<span class="token comment">//24个线程消费生成的数据</span>
<span class="token keyword">func</span> <span class="token function">JobChan</span><span class="token punctuation">(</span>wg <span class="token operator">*</span>sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">,</span> ch <span class="token keyword">chan</span> <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>sumInfo <span class="token keyword">chan</span> <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// var chresult chan&lt;- int64</span>
	sumInfo <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int64</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{<!-- --></span>
		wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ch <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

			<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
				temp <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
				sum <span class="token operator">:=</span> <span class="token function">GetSum</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"temp is "</span><span class="token punctuation">,</span> temp<span class="token punctuation">)</span>
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"sum is "</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>
				sumInfo <span class="token operator">&lt;-</span> sum
			<span class="token punctuation">}</span>
			wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>

	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 wg <span class="token operator">:=</span> sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	chOrigin <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int64</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span>
	<span class="token comment">// ch1 := make(chan int64, 300)</span>
	<span class="token keyword">go</span> <span class="token function">generateRandomNumber</span><span class="token punctuation">(</span>chOrigin<span class="token punctuation">)</span>
	chSum <span class="token operator">:=</span> <span class="token function">JobChan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wg<span class="token punctuation">,</span> chOrigin<span class="token punctuation">)</span>
	<span class="token keyword">for</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> chSum <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"*&amp;*&amp;*&amp;*&amp;*&amp;***&amp;**"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// wg.Wait()</span>
	<span class="token comment">// select {}</span>
<span class="token punctuation">}</span>

<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4334&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li></ul></pre>
</div>

<script>

// ==UserScript==
// @name CSDN Del Copy
// @namespace AceScript Scripts
// @match *://blog.csdn.net/*
// @grant none
// ==/UserScript==
const bra = {
    del_csdn_copy: function (){
        console.log("del_csdn_copy1");
        let blog = document.getElementById("content_views");
        blog.setAttribute("id", "content_views2");
    },
};

(function (){
    "use strict";
    bra.del_csdn_copy();

})();

</script>

</body>
</html>